<input
  *ngIf="!isAutocomplete"
  autocapitalize="off"
  autocomplete="off"
  matInput
  [formControl]="inputControl"
  [matAutocomplete]="symbolAutocomplete"
/>

<mat-select
  *ngIf="isAutocomplete"
  [displayWith]="displayFn"
  [formControl]="selectControl"
  (keydown)="onShowAutocomplete($event)"
  (selectionChange)="onSelectUpdateSymbol($event)"
>
  @for (lookupItem of defaultLookupItems; track lookupItem) {
    <mat-option
      class="line-height-1"
      [disabled]="lookupItem.dataProviderInfo.isPremium"
      [value]="lookupItem"
    >
      <span class="align-items-center d-flex line-height-1"
        ><span>{{ lookupItem.name }}</span>
        @if (lookupItem.dataProviderInfo.isPremium) {
          <gf-premium-indicator class="ml-1" [enableLink]="false" />
        }
      </span>
      <small class="text-muted"
        >{{ lookupItem.symbol | gfSymbol }} · {{ lookupItem.currency }}
        @if (lookupItem.dataProviderInfo.name) {
          · {{ lookupItem.dataProviderInfo.name }}
        }
      </small>
    </mat-option>
  }
</mat-select>

<mat-autocomplete
  #symbolAutocomplete
  [displayWith]="displayFn"
  (optionSelected)="onAutocompleteUpdateSymbol($event)"
>
  @if (!isLoading) {
    @for (lookupItem of filteredLookupItems; track lookupItem) {
      <mat-option
        class="line-height-1"
        [disabled]="lookupItem.dataProviderInfo.isPremium"
        [value]="lookupItem"
      >
        <span class="align-items-center d-flex line-height-1"
          ><span>{{ lookupItem.name }}</span>
          @if (lookupItem.dataProviderInfo.isPremium) {
            <gf-premium-indicator class="ml-1" [enableLink]="false" />
          }
        </span>
        <small class="text-muted"
          >{{ lookupItem.symbol | gfSymbol }} · {{ lookupItem.currency }}
          @if (lookupItem.assetSubClass) {
            · {{ lookupItem.assetSubClassString }}
          }
          @if (lookupItem.dataProviderInfo.name) {
            · {{ lookupItem.dataProviderInfo.name }}
          }
        </small>
      </mat-option>
    } @empty {
      @if (inputControl.value?.length > 1) {
        <mat-option class="line-height-1" disabled="true" i18n
          >Oops! Could not find any assets.</mat-option
        >
      }
    }
  }
</mat-autocomplete>

@if (isLoading) {
  <mat-spinner class="position-absolute" [diameter]="20" />
}
